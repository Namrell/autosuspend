{"name":"Autosuspend","tagline":"a daemon to suspend your server on certain conditions","body":"# autosuspend\r\n===========\r\n\r\nAutosuspend is a python daemon that suspends a system if certain conditions are met, or not met.\r\n\r\n## Requirements\r\n============\r\npython3 with the following modules:  os, sys, configparser, logging,  psutil,  subprocess,  time,  threading,  logging, http.server\r\n\r\n## Features\r\n========\r\nIt can currently check the following conditions:\r\n\r\n### SSH:\r\n    by matching user\r\n        any username that matches a given list blocks suspend\r\n    by matching host\r\n        any hostname that matches a given list blocks suspend\r\n\r\n### SAMBA:\r\n    any active Samba connection will block suspend.\r\n        Since this uses the output of smbstatus it (or the package that contains) it must be installed. Also it parses the output of smbstatus. \r\n        **NOTICE**: If your smbstatus output doesn't use a ---- to divide the heading from list of connections it will fail\r\n\r\n### LOAD:\r\n    if the current systemload is greater than a given value suspend will be blocked.\r\n        **NOTICE**: Change the load according to your system. For example: A load of 2.7 is very high for a single cpu system, while it is light load for a quad-cpu system.\r\n\r\n### PING:\r\n    if one of the hosts respond to a ICMP request suspend will be blocked\r\n\r\n### PROCESSES:\r\n    if currently running processes match the suspend will be blocked.\r\n        You might use this to hinder the system from suspending when for example your rsync runs\r\n\r\n### WEBSERVER:\r\n    if a http connection is made to the port the system will suspend immediately\r\n        This is a way to directly initiate a suspend. If you open the port in a webbrowser the suspend will be initiated immediately.\r\n        **NOTICE**: For safety reasons you should set a password. This might not be secure, but will make it harder to suspend the system by accident. \r\n        you can disable the password by leaving it empty.\r\n        The suspending by webserver is not checking for the other conditions to apply. it will suspend instantly\r\n\r\n## Acknowledgements\r\n================\r\n_daemon.py_ by [http://workaround.cz/daemon-in-python-3/](http://workaround.cz/daemon-in-python-3/)\r\n        \r\n## Example configuration file\r\n===========\r\nThe following options should be put in /etc/autosuspend.conf\r\n```\r\n[autosuspend]\r\ninterval=600\r\ndebug=true\r\nping=true\r\npinghosts=client,raspberrypi\r\nssh=true\r\nsshusers=user,user2\r\nsshhosts=client2,raspberrypi\r\nwebhost=true\r\nwebport=4567\r\nwebpass=password\r\nsmb=true\r\nloadthreshold=1.5\r\nprocesses=rsync,clamav\r\nsuspend_cmd = /bin/echo\r\nlogfile = /var/log/autosuspend.log\r\n```\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}